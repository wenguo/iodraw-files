```mermaid
graph TD

    %% --- 实际部署环境 ---
    subgraph SITE[现场环境]
        DEV1[温度传感器（Modbus-RTU）]
        DEV2[电表设备\n（RS485）]
        DEV3[LoRa 无线节点]
    end

    %% --- 网关设备 ---
    subgraph GW[物联网网关]
        subgraph MID[协议中间件]
            DIO[驱动接口调用结构]
            PARSE[协议解析结构]
            UMF[UMF 统一中间格式]
            MODEL[物模型管理结构]
            MQTT[MQTT 适配结构]
            PROC[协议进程自适应调度结构]
        end
    end

    %% --- 上层平台 ---
    subgraph CLOUD[上层物联控制系统]
        CTRL[控制系统业务平台]
    end

    %% --- 数据流 ---
    DEV1 -->|原始协议帧| DIO
    DEV2 -->|原始协议帧| DIO
    DEV3 -->|原始协议帧| DIO

    DIO --> PARSE
    PARSE --> UMF
    UMF --> MODEL
    MODEL --> MQTT
    MQTT --> CTRL

    %% --- 控制指令返回 ---
    CTRL -->|UMF 控制指令| MQTT
    MQTT --> MODEL
    MODEL --> PARSE
    PARSE --> DIO
    DIO -->|原生控制命令帧| DEV1

    %% --- 调度控制 ---
    PROC -.监测/调节运行状态.-> PARSE
    PROC -.监测/调节运行状态.-> DIO

```